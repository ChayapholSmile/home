<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrueMoney Wallet Top-up</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
                Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            background-color: #f4f4f9;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        #app {
            background-color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px_12px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        h3 {
            color: #333;
            margin-top: 0;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .info-container {
            text-align: left;
            margin-bottom: 20px;
        }

        .copy-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            padding: 8px;
            border: 1px solid #eee;
            border-radius: 8px;
        }
        
        .copy-container span {
            word-break: break-all;
        }

        .copy-btn {
            font-size: 16px;
            cursor: pointer;
            border: none;
            background-color: transparent;
            padding: 5px;
        }

        /* Container ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö QR Code ‡πÅ‡∏•‡∏∞‡πÇ‡∏•‡πÇ‡∏Å‡πâ */
        #qrcode-container {
            position: relative; /* ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å! ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏•‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ */
            display: inline-block; /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ container ‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö QR Code */
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        #qrcode {
            display: flex;
            justify-content: center;
        }

        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ç‡∏≠‡∏á‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
        .qrcode-logo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏õ‡πä‡∏∞‡πÜ */
            width: 50px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡πÇ‡∏•‡πÇ‡∏Å‡πâ */
            height: 50px;
            background-color: white; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
            padding: 5px; /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏Å‡∏±‡∏ö‡∏Ç‡∏≠‡∏ö */
            border-radius: 8px; /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ç‡∏≠‡∏ö‡∏°‡∏ô */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .error {
            color: #d9534f;
            font-weight: 600;
            padding: 15px;
            border: 1px solid #d9534f;
            border-radius: 8px;
            background-color: #f2dede;
        }
    </style>
</head>
<body>
    <div id="app">
        <div v-if="phone">
            <h3>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ö‡∏±‡∏ç‡∏ä‡∏µ TrueMoney</h3>
            <div class="info-container">
                <div class="copy-container">
                    <span>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: {{ phone }}</span>
                    <button class="copy-btn" @click="copyText(phone)" title="‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">üìã</button>
                </div>
                <div class="copy-container">
                    <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: <b>{{ amount }}</b> ‡∏ø</span>
                </div>
                <div class="copy-container">
                    <span>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: {{ message }}</span>
                    <button class="copy-btn" @click="copyText(message)" title="‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°">üìã</button>
                </div>
            </div>

            <h3>‡∏´‡∏£‡∏∑‡∏≠‡∏™‡πÅ‡∏Å‡∏ô QR Code</h3>
            
            <div id="qrcode-container">
                <div id="qrcode"></div>
                <img src="https://img.uxwing.com/wp-content/themes/uxwing/download/brands-social-media/true-money-wallet-logo-icon.png" class="qrcode-logo" alt="TrueMoney Logo">
            </div>

        </div>
        <div class="error" v-else>
            ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô! <br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    isMobile: false,
                    phone: "",
                    amount: "",
                    message: "",
                    deeplink: ""
                };
            },
            mounted() {
                this.isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
                
                const urlParams = new URLSearchParams(window.location.search);
                this.phone = urlParams.get("phone") || "";
                this.amount = urlParams.get("amount") || "";
                this.message = urlParams.get("message") || "";

                if (this.phone) {
                    this.generateQR();
                }

                // *** ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ***
                if (this.isMobile && this.phone) {
                    this.openDeeplink();
                }
            },
            methods: {
                generateQR() {
                    const methodData = JSON.stringify({
                        "tmn_phone": this.phone,
                        "tmn_msg": this.message,
                        "tmn_amount": this.amount ? Number(this.amount) : undefined
                    });

                    this.deeplink = `ascendmoney://wallet.truemoney.co.th/app/660000000005?type=constant&method=${encodeURIComponent(methodData)}`;

                    document.getElementById("qrcode").innerHTML = "";
                    new QRCode(document.getElementById("qrcode"), {
                        text: this.deeplink,
                        width: 256,
                        height: 256,
                        colorDark: "#000000",
                        colorLight: "#ffffff",
                        // *** ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Error Correction ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö H (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î) ***
                        // ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡πÅ‡∏Å‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πâ‡∏°‡∏µ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á
                        correctLevel: QRCode.CorrectLevel.H 
                    });
                },
                openDeeplink() {
                    if (this.deeplink) {
                        window.location.href = this.deeplink;
                    }
                },
                copyText(text) {
                    navigator.clipboard.writeText(text).then(() => {
                        alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + text);
                    }).catch(err => {
                        console.error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏î‡πâ: ", err);
                        alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
                    });
                }
            }
        }).mount("#app");
    </script>
</body>
</html>